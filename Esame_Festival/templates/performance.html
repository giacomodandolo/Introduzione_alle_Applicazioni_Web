{% extends "base.html" %}
{% block title %}Performance{% endblock title %} 

{% block body_content %}
<main class="h-100 col-sm-12 col-md-9 col-lg-6 m-auto mb-4">
    <section class="card p-2 bg-primary">
        {% if p_request_type == 0 %} 
        <!-- INSERT PERFORMANCE -->
        <h2 class="card-header text-center text-primary border-common">Inserimento della performance</h2>
        <form action="{{ url_for('performance_post', method='POST')}}" class="card-body" method="POST" enctype="multipart/form-data">
            <!-- ARTIST -->
            <section class="h-100 border-bottom mb-4 pb-3">
                <h3 class="text-secondary border-common">Informazioni dell'artista</h3>
                <!-- NAME -->
                <label for="artist_name" class="form-label text-common">Nome</label>
                <input type="text" name="name" id="artist_name" class="form-control mb-3" placeholder="Mario" maxlength="100" required>
                <!-- SHORT DESCRIPTION -->
                <label for="artist_short_description" class="form-label text-common">Breve descrizione</label>
                <textarea name="short_description" id="artist_short_description" class="form-control mb-3" placeholder="Breve descrizione dell'artista" maxlength="100" required></textarea>
                <!-- DESCRIPTION -->
                <label for="artist_description" class="form-label text-common">Descrizione</label>
                <textarea name="artist_description" id="artist_description" class="form-control mb-3" placeholder="Lunga descrizione dell'artista" maxlength="512" rows="4" required></textarea>
                <!-- IMAGE -->
                <label for="artist_image_id" class="form-label text-common">Immagine</label>
                <input type="file" name="artist_image" id="artist_image_id" class="form-control" required>
                <span class="form-text text-common-dark">L'immagine deve essere in formato jpg, jpeg, png o webp</span>
            </section>
            <!-- PERFORMANCE -->
            <section class="h-100 border-bottom mb-4">
                <h3 class="text-secondary border-common">Informazioni della performance</h3>
                <!-- START -->
                <label for="performance_start_date" class="form-label text-common">Data inizio</label>
                <input type="datetime-local" name="start_date" id="performance_start_date" class="form-control mb-3" min="2025-07-18 00:00" max="2025-07-20 23:59" placeholder="2025-07-18 00:00" required>
                <!-- END -->
                <label for="performance_end_date" class="form-label text-common">Data fine</label>
                <input type="datetime-local" name="end_date" id="performance_end_date" class="form-control mb-3" min="2025-07-18 00:00" max="2025-07-20 23:59" placeholder="2025-07-18 00:00" required>
                <!-- MUSIC GENRE -->
                <label for="music_genre" class="form-label text-common">Genere musicale</label>
                <input type="text" name="music_genre" id="music_genre" class="form-control mb-3" placeholder="Rock" maxlength="100" required>
                <!-- STAGE -->
                <label for="performance_stage" class="form-label text-common">Palco</label>
                <select name="stage" id="performance_stage" class="form-select mb-3">
                    {% for stage in p_stage %}
                    <option value="{{ stage.id }}">{{ stage.name }}</option>
                    {% endfor %}
                </select>
                <!-- DESCRIPTION -->
                <label for="performance_description" class="form-label text-common">Descrizione</label>
                <textarea name="performance_description" id="performance_description" class="form-control mb-3" placeholder="Lunga descrizione della performance" maxlength="512" rows="4" required></textarea>
                <!-- IMAGE -->
                <label for="performance_image_id" class="form-label text-common">Immagine</label>
                <input type="file" name="performance_image" id="performance_image_id" class="form-control" required>
                <div class="form-text mb-3 text-common-dark">L'immagine deve essere in formato jpg, jpeg, png o webp</div>
                <!-- DRAFT -->
                <div class="form-check">
                    <label for="draft_box" class="form-label text-common">Bozza</label>
                    <input class="form-check-input" type="checkbox" name="draft_box" value="0" id="draft_box" checked>
                </div>
            </section>
            <input type="submit" name="submitBtn" value="Crea performance" class="btn">
        </form>
        {% else %}
        <!-- UPDATE PERFORMANCE -->
        <h2 class="card-header text-center text-primary border-common">Aggiornamento della performance</h2>
        <form action="{{ url_for('update_performance', artist_id=p_performance.artist_id, method='POST')}}" class="card-body" method="POST">
            <!-- ARTIST -->
            <section class="h-100 border-bottom mb-4">
                <h3 class="text-secondary border-common">Informazioni dell'artista</h3>
                <!-- NAME -->
                <label for="artist_name" class="form-label text-common">Nome</label>
                <input type="text" name="name" id="artist_name" class="form-control mb-3" placeholder="Mario" maxlength="50" value="{{ p_performance.artist_name }}" required>
                <!-- SHORT DESCRIPTION -->
                <label for="artist_short_description" class="form-label text-common">Breve descrizione</label>
                <textarea name="short_description" id="artist_short_description" class="form-control mb-3" placeholder="Breve descrizione dell'artista" maxlength="50" required>{{ p_performance.short_description }}</textarea>
                <!-- DESCRIPTION -->
                <label for="artist_description" class="form-label text-common">Descrizione</label>
                <textarea name="artist_description" id="artist_description" class="form-control mb-3" placeholder="Lunga descrizione dell'artista" maxlength="255" rows="4" required>{{ p_performance.artist_description }}</textarea>
            </section>
            <!-- PERFORMANCE -->
            <section class="h-100 border-bottom mb-4">
                <h3 class="text-secondary border-common">Informazioni della performance</h3>
                <!-- START -->
                <label for="performance_start_date" class="form-label text-common">Data inizio</label>
                <input type="datetime-local" name="start_date" id="performance_start_date" class="form-control mb-3" min="2025-07-18 00:00" max="2025-07-20 23:59" placeholder="2025-07-18 00:00" value="{{ p_performance.start_date }}"required>
                <!-- END -->
                <label for="performance_end_date" class="form-label text-common">Data fine</label>
                <input type="datetime-local" name="end_date" id="performance_end_date" class="form-control mb-3" min="2025-07-18 00:00" max="2025-07-20 23:59" placeholder="2025-07-18 00:00" value="{{ p_performance.end_date }}"required>
                <!-- MUSIC GENRE -->
                <label for="music_genre" class="form-label text-common">Genere musicale</label>
                <input type="text" name="music_genre" id="music_genre" class="form-control mb-3" placeholder="Rock" maxlength="50" value="{{ p_performance.music_genre }}" required>
                <!-- STAGE -->
                <label for="performance_stage" class="form-label text-common">Palco</label>
                <select name="stage" id="performance_stage" class="form-select mb-3">
                    {% for stage in p_stage %}
                    <option value="{{ stage.id }}" {% if p_performance.stage_id == stage.id %} selected {% endif %} >{{ stage.name }}</option>
                    {% endfor %}
                </select>
                </div>
                <!-- DESCRIPTION -->
                <label for="performance_description" class="form-label text-common">Descrizione</label>
                <textarea name="performance_description" id="performance_description" class="form-control mb-3" placeholder="Lunga descrizione della performance" maxlength="255" rows="4" required>{{ p_performance.performance_description }}</textarea>
                <!-- DRAFT -->
                <div class="form-check">
                    <label for="draft_box" class="form-label text-common">Bozza</label>
                    <input class="form-check-input mb-3" type="checkbox" name="draft_box" value="0" id="draft_box" checked>
                </div>
            </section>
            <input type="submit" name="submitBtn" value="Aggiorna performance" class="btn">
        </form>
        {% endif %}
    </section>
</main>
{% endblock body_content %}